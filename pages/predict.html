---
permalink: /predict/
layout: base
title: Predicted expression
version: v4
---

<link
  rel="stylesheet"
  href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.min.css"
  crossorigin="anonymous"
/>

<h1>Genetically predicted RNA phenotypes</h1>

<p>
  cis-genetic associations can be used to predict quantitative RNA phenotypes
  such as gene expression levels and isoform ratios. These values estimate
  z-scores of the phenotypes, rather than absolute levels, but can be used to:
</p>

<ul>
  <li>
    Stratify individuals by a gene's genetically predicted expression or other
    RNA phenotype to test hypotheses about the gene's role in observed traits.
    See
    <a
      href="https://www.biorxiv.org/content/10.1101/2025.10.14.682432.abstract"
    >
      Campo et al. 2025 (preprint)
    </a>
  </li>
  <li>
    Test whether observed gene expression differences in groups with divergent
    traits are only a downstream effect of exposures or whether they have a more
    direct genetic component. See
    <a href="https://www.nature.com/articles/s41593-023-01452-y">
      Zhou et al. 2023
    </a>
  </li>
</ul>

<p>
  We provide predictions for <strong>124,502</strong> unique RNA phenotypes for
  <strong>19,885 genes</strong> for all rats genotyped by our NIDA center (Round
  11.2, N=24,722). These include only phenotypes that are heritable (P&le;0.01)
  in the indicated tissue.
</p>

<h3>Download predictions</h3>

<table class="download-matrix">
  <tbody>
    {% assign modalities = site.data.modalities %} {% for modality in modalities
    %}
    <tr>
      <td>{{ modality.name }}</td>
      {% for tissue in site.data.versions[page.version].tissues %}
      <td>
        <a
          href="/data/predict/pred-round11_2-{{ tissue.id }}-{{ modality.id }}.tsv.gz"
          title="{{ tissue.name }}"
          download
        >
          {{ tissue.id }}
        </a>
      </td>
      {% endfor %}
    </tr>
    {% endfor %}
  </tbody>
</table>

<p>
  The table below shows per-phenotype heritability estimates (h<sup>2</sup>) and
  cross-validated model accuracy for heritable RNA phenotypes in each tissue.
</p>

<p>
  <a href="/data/predict/phenotype_stats.tsv.gz">Download TSV (gzip)</a>
  <span class="ms-2 text-muted" id="row-summary"></span>
  <span id="loading" class="ms-3 text-muted">Loadingâ€¦</span>
  <span id="error" class="ms-3 text-danger" style="display: none"></span>
  <noscript>
    <span class="text-danger">
      This page requires JavaScript to display the table.
    </span>
  </noscript>
</p>

<div id="table-container" style="display: none; overflow-x: auto">
  <table id="predict-table" class="display" width="100%"></table>
  <p class="mt-2 text-muted">
    Search the table using the box above. Click column headers to sort.
  </p>
</div>

<script
  src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"
  crossorigin="anonymous"
></script>
<script
  src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"
  crossorigin="anonymous"
></script>
<script>
  (async function () {
    const url = "/data/predict/phenotype_stats.tsv.gz";
    const loadingEl = document.getElementById("loading");
    const errorEl = document.getElementById("error");
    const tableContainer = document.getElementById("table-container");
    const rowSummary = document.getElementById("row-summary");
    const GENE_COL_INDEX = 2;

    function setError(msg) {
      if (loadingEl) loadingEl.style.display = "none";
      if (errorEl) {
        errorEl.textContent = msg || "Failed to load data.";
        errorEl.style.display = "";
      }
    }

    function parseNumber(value) {
      const num = parseFloat(value);
      return Number.isFinite(num) ? num : null;
    }

    async function loadTextFile(tUrl) {
      const resp = await fetch(tUrl, { cache: "no-store" });
      if (!resp.ok) {
        throw new Error("HTTP " + resp.status + " while fetching " + tUrl);
      }
      const buffer = await resp.arrayBuffer();
      const bytes = new Uint8Array(buffer);
      const isGzip =
        bytes.length >= 2 && bytes[0] === 0x1f && bytes[1] === 0x8b;
      const decoder = new TextDecoder("utf-8");
      if (isGzip) {
        if (typeof pako === "undefined" || !pako.ungzip) {
          throw new Error("Unable to decompress gzip data.");
        }
        return decoder.decode(pako.ungzip(bytes));
      }
      return decoder.decode(bytes);
    }

    try {
      const text = await loadTextFile(url);
      const lines = text.trim().split(/\r?\n/);
      if (!lines.length) {
        throw new Error("Empty file");
      }

      const header = lines[0].split("\t");
      const colIndex = header.reduce((acc, name, idx) => {
        acc[name.trim()] = idx;
        return acc;
      }, {});

      const requiredColumns = [
        "tissue",
        "modality",
        "gene_id",
        "phenotype_id",
        "hsq",
        "hsq_se",
        "hsq_pval",
        "model_type",
        "model_cv_r2",
        "model_cv_pval",
      ];
      const missingColumn = requiredColumns.find((key) => !(key in colIndex));
      if (missingColumn) {
        throw new Error("Missing expected column: " + missingColumn);
      }

      const data = [];
      for (let i = 1; i < lines.length; i++) {
        const line = lines[i];
        if (!line || !line.trim()) continue;
        const parts = line.split("\t");
        const row = [
          parts[colIndex["tissue"]] || "",
          parts[colIndex["modality"]] || "",
          parts[colIndex["gene_id"]] || "",
          parts[colIndex["phenotype_id"]] || "",
          parseNumber(parts[colIndex["hsq"]]),
          parseNumber(parts[colIndex["hsq_se"]]),
          parseNumber(parts[colIndex["hsq_pval"]]),
          parts[colIndex["model_type"]] || "",
          parseNumber(parts[colIndex["model_cv_r2"]]),
          parseNumber(parts[colIndex["model_cv_pval"]]),
        ];
        data.push(row);
      }

      if (loadingEl) loadingEl.style.display = "none";
      if (tableContainer) tableContainer.style.display = "";

      if (rowSummary) {
        rowSummary.textContent = data.length
          ? `Loaded ${data.length.toLocaleString()} phenotypes`
          : "";
      }

      $.fn.dataTable.ext.search.push(function (settings, dataRow) {
        if (settings.nTable.id !== "predict-table") return true;
        const input = $(".dataTables_filter input").val();
        if (!input || input.trim() === "") return true;
        const normalizedSearch = input.toLowerCase();
        const gene = (dataRow[GENE_COL_INDEX] || "").toLowerCase();
        return gene === normalizedSearch;
      });

      $("#predict-table").DataTable({
        data,
        columns: [
          { title: "Tissue", className: "dt-nowrap" },
          { title: "Modality", className: "dt-nowrap" },
          { title: "Gene", className: "dt-nowrap" },
          { title: "Phenotype", className: "dt-nowrap" },
          { title: "h<sup>2</sup>", className: "dt-right" },
          { title: "h<sup>2</sup> SE", className: "dt-right" },
          { title: "h<sup>2</sup> p-value", className: "dt-right" },
          { title: "Model type", className: "dt-nowrap" },
          { title: "CV r<sup>2</sup>", className: "dt-right" },
          { title: "CV p-value", className: "dt-right" },
        ],
        order: [[8, "desc"]],
        pageLength: 10,
        deferRender: true,
        autoWidth: false,
        responsive: true,
        columnDefs: [{ targets: [4, 5, 6, 8, 9], type: "num" }],
        language: {
          search: "Search gene (exact match):",
        },
      });
    } catch (err) {
      console.error(err);
      setError("Unable to load prediction accuracy table.");
    }
  })();
</script>
